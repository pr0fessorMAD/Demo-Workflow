name: Workflow DAG Structure Demo (needs)

on:
  workflow_dispatch:

jobs:
  # Job A: Runs first, no dependencies
  setup-job:
    runs-on: ubuntu-latest
    steps:
      - name: Start Setup
        run: echo "Starting Setup Job..."
      - name: Simulate Setup Tasks
        run: sleep 5
      - name: Setup Complete
        run: echo "Setup Job finished."

  # Job B: Waits for Job A to complete
  build-job:
    runs-on: ubuntu-latest
    needs: [setup-job]  # This is the key: forces waiting for setup-job
    steps:
      - name: Start Build
        run: echo "Starting Build Job, only after Setup is done."
      - name: Simulate Build Tasks
        run: sleep 5
      - name: Build Complete
        run: echo "Build Job finished successfully."
        
  # Job C: Waits for Job B to complete
  test-job:
    runs-on: ubuntu-latest
    needs: [build-job]  # Waits for the previous job
    steps:
      - name: Start Testing
        run: echo "Starting Test Job, only after Build is done."
      - name: Test Complete
        run: echo "Testing finished."